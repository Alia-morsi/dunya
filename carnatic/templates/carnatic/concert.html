{% extends "carnatic/base.html" %}
{% load inline %}
{% load badges %}
{% load staticfiles %}

{% block script %}
<script>
$(document).ready(function() {
	//$("#filterMask").toggleClass('querybar');
    //parseAllFilters({{ filter_items|safe }});
    //widthOfChildren('.metaContainer');

    $("#performers").isotope();
    $("#similarconcerts").isotope();
	
	$("#icon").on("click", function(){
		{% if user.is_authenticated %}
				{% for t in tracks %}
						SCM.queue({title:'{{t.title}} by {% inline_recording_artist t %}', url: '{% url_host_and_path request t.absolute_mp3_url %}'});
				{% endfor %}
				SCM.play();
		{% else %}
				$( "#playback_dialog" ).dialog( "open" );
		{% endif %}
     });
	
	$( ".player" ).click(function() {
      console.log($(this).prop("tagName"));
      $( "#playback_dialog" ).dialog( "open" );
    });
	
});
</script>
{% endblock %}

{% block title %}{{concert.title}} - {% endblock %}

{% block wrap %}
<!--
    <div id="filterMask">
	    <div id="filterArea">

	    	<div id="entitiesList" class="filterList">
	    		<h3>Chose your query</h3>
	        	<ul>

	        	</ul>
	    	</div>

	    	<div id="breadcrumb">
	    		<div class="bread entity_1 artist">
	    			<div class="breadarrow"></div>
	    			<span><a href="#">No selection</a></span>
	    		</div>
	    		<div class="bread entity_3 work">
	    			<div class="breadarrow"></div>
	    			<span><a href="#">No selection</a></span>
	    		</div>
	    		<div class="bread entity_4 instrument">
	    			<div class="breadarrow"></div>
	    			<span><a href="#">No selection</a></span>
	    		</div>
	    	</div>

	    </div>
     </div>
     -->
     <div id="detail" class="concert">
     	<div id="header">
     		<div id="summary">
     			<div id="innerSummary">
	     			<span>
		     			<h1>{{concert.title}}</h1>
		     			<h2>Release by {%inline_artist_list concert.artistnames %}</h2>
	     			</span>
     			</div>
				
     			<div id="summaryBack"></div>
     			<div id="icon"></div>
     		</div>
            <div class="bigImage"><img src="{{image}}" /></div>
     		<div id="meta">
     			<div class="metaBlock">
					<div class="metaMask">
			 			<div class="metaContainer">
							<div  class="splitMeta">
								<div id="editorial" class="metaDetails">
									<h3>Editorial Metadata</h3>
									<div class="inner">
										<span class='list'>
                                            <label>Year:</label><b>{{concert.year}}</b>
                                            <label>length:</label><b>{{concert.length}}</b>
                                            <label>Data source:</label><a href="{{concert.ref.url}}">{{concert.ref.title}}</a>
									</div>
								</div>
								<div id="samples" class="metaDetails">
									<h3>Samples</h3>
									<div class="inner">
										<span>
										    {% if user.is_authenticated %}
										        {% for s in samples %}
										   		    <div class="ui360"><a href="{{s.absolute_mp3_url}}">{{s.title}}</a></div>
												{% endfor %}
												
											{% else %}
												{% for s in samples %}
										   		    <div class="player">{{s.title}}</div>
												{% endfor %}
										    {% endif %}
										</span>
									</div>
								</div>
							</div>

			 			</div>
			 		</div>
			 	</div>
     		</div>

	     	<div class="clearfix"></div>

     	</div><!-- HEADER END -->
	 	<div class="alldata">
	     	<div class="thedata">
	     		<div class="leftdata">
		     		<h3>List of tracks</h3>
	     		</div>
	     		<div class="rightdata">
	     			<div class="innerrightdata scrolldata nopad">
	                    <div class="scrollblock">
                            {% for t in concert.tracks.all %}
                            {% badge_recording t %}
                            {% endfor %}
	                    </div>
	     			</div>
	     		</div>
	     	</div>

	     	<div class="thedata">
	     		<div class="leftdata">
		     		<h3>Accompanying artists</h3>
	     		</div>
	     		<div class="rightdata">
	     			<div class="innerrightdata nopad">
                        <div class="scrollblock" id="results">
	                    {% for performance in concert.performers %}
	                        {% badge_performance performance %}
	                    {% endfor %}
                        </div>
		     			<div class="clearfix"></div>
	     			</div>
	     		</div>
	     	</div>
	     	<div class="thedata">
	     		<div class="leftdata">
		     		<h3>Similar concerts</h3>
	     		</div>
	     		<div class="rightdata">
	     			<div class="innerrightdata scrolldata">
	                    <div class="scrollblock" id="results">
                            {% for concert, similarity in similar_concerts %}
                                {% badge_similar_concert concert similarity %}
                            {% endfor %}
	                    </div>
	     			</div>
	     		</div>
	     	</div>

            {% comment %}
            {% include "carnatic/social.html" %}
            {% endcomment %}

		 	<div class="clearfix"></div>
	 	</div>
</div>

{% endblock %}
