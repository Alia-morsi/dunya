{% extends "motifdiscovery/base.html" %}
{% load staticfiles %}
{% block body %}
{% load app_filters %}
<h1>Seeds for {{recording.title}}</h1>
        
        <ul>
         <table>
         <tr>
                <td><h5>Similarity</h5></td>
                <td><h5>Seed_Id</h5></td>
                <td><h5>Start(s)</h5></td>
                <td><h5>End(s)</h5></td>
                <td><h5>Pair_Id</h5></td>
                <td><h5>Start(s)</h5></td>
                <td><h5>End(s)</h5></td>
                <td><h5>Musicbrainz ID</h5></td>
                

         </tr>
         {% for seed in patterns %}
        
            <tr>                
                {% if forloop.counter0 < 5  %}
                    <td><img src="{% static "motifdiscovery/correct.png" %}" width="16" height="16"></td>
                {% else %}
                    <td><img src="{% static "motifdiscovery/wrong.png" %}" width="12" height="12"></td>
                {% endif %}
                
                <td><a href="" class="seed" data-pattern="{{seed.id}}">{{seed.source.id}}</a></td>
                <td>{{seed.source.start_time|roundOff}}</td>
                <td>{{seed.source.end_time|roundOff}}</td>
                
                <td><a href="" class="seed" data-pattern="{{seed.target.id}}">{{seed.target.id}}</a></td>
                <td>{{seed.target.start_time|roundOff}}</td>
                <td>{{seed.target.end_time|roundOff}}</td>
                <td><a href = "http://musicbrainz.org/recording/{{seed.target.file.mbid}}">{{seed.target.file.mbid}}</a></td>

            </tr>
        {% endfor %}
         </table>
        </ul>
        
        
        <script type="text/javascript">
            $(function() {
                var mbid = '{{patterns.0.file.mbid}}';
                soundManager.setup({
                    url: '{% static 'motifdiscovery/swf' %}',
                    preferFlash: false,
                    onready:  function() {
                    },
                });

            $(".seed").click(function(e) {
                    e.preventDefault();
                    var seed = $(this).data('pattern');
                    var mbid = $(this).data('mbid');
                    var start = parseInt($(this).data('start')) * 1000;
                    var end = parseInt($(this).data('end')) * 1000;

                         var sound = soundManager.createSound({
                             id: 'sound'+mbid,
                             url: 'http://dunya.compmusic.upf.edu/document/by-id/'+mbid+'.mp3',

            position: start,
            from: start,
            to: end,
							 autoLoad: true
                         });
						console.debug("mbid");
						console.debug(mbid);
						console.debug("start");
						console.debug(start);
						console.debug(end);
					sound.unload();

        sound.play({
            from: start,
            position: start,
            to: end,
            onstop: function() {
                soundManager._writeDebug('sound stopped at position ' + this.position);
            }
        });
                    }); 
    $("#stop").click(function(e) {
        e.preventDefault();
        soundManager.stopAll();
    });

});
        
        </script>

{% endblock %}
{% block footer %}
We obtain melodic similarity thresholds using expert feedback (explanation in the submitted article) and indicate similar by <img src="{% static "motifdiscovery/correct.png" %}" width="16" height="16"> and not similar by <img src="{% static "motifdiscovery/wrong.png" %}" width="12" height="12"><br/>
*Time stamps are rounded off to 1 decimal point just for the sake of displaying
{% endblock %}
{% block nav %}
<li><a href="{% url 'motif-main'%}">Browsing options</a></li>
<li><a href="{% url 'motif-artists'%}">Artist list </a></li>
<li><a>Releases </a></li>
<li><a href="{% url 'motif-release' recording.concert_set.get.mbid %}">Recordings</a></li>
<li><a href="{% url 'motif-seeds' recording.mbid %}">Seeds</a></li>
<br>
<br>
<a href="" id="stop">Stop Audio</a><p>

{% endblock %}        
